const hubConnection=(new signalR.HubConnectionBuilder).withUrl(HubUrl).configureLogging(signalR.LogLevel.Information).build();var UpdatingMessagesNow=!1;$(document).ready(function(){hubConnection.on("Send",function(n,t,i,r,u){DialogID===r?($("#dialog").append(`<div class="mt-2">
                    <div class="d-flex">
                        <b class="border-bottom w-100">`+t+`</b>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>
                           `+n+`
                        </span>
                        <span id="date">`+i+`</span>
                    </div>
                </div>`),$("#message").val(""),$("#dialog").scrollTop($("#dialog")[0].scrollHeight),$("#inputForm input").focus()):(toastr.info(`Вам пришло новое сообщение от ${t}`),toastr.info(`<a href="~/Dialog/WithId/${r}">
	                        <p>Новое сообщение!</p>
	                        <div class="d-flex">
		                        <div style="background-image: url('${u}'); background-size:cover; background-position:center; width: 40px; height: 40px; border-radius: 100%;"></div>
		                        <div>
			                        <b>${t}</b>
			                        <p>${n}</p>
		                        </div>
	                        </div>
                        </a>`))});document.getElementById("sendBtn").addEventListener("click",function(){let n=document.getElementById("message").value;hubConnection.invoke("Send",n,DialogID)});hubConnection.start();$("#inputForm input").focus();$("#inputForm input").keyup(function(n){var t=n.key;t==="Enter"&&(n.preventDefault(),$("#sendBtn").click())});$("#dialog").scroll(function(){$("#dialog").scrollTop()<=500&&UpdatingMessagesNow===!1&&TotalCount>Offset*50&&(UpdatingMessagesNow=!0,axios.get("/Dialog/GetMessagesJSON",{params:{dialogId:DialogID,offset:Offset*50}}).then(n=>{n.data.messageList.forEach(n=>{$("#dialog").prepend(`
                            <div class="mt-3">
			            	    <div class="d-flex">
					                <b class="border-bottom w-100">${n.fullName}</b>
				                </div>
				                <div class="d-flex justify-content-between">
					                <span>
					        	       ${n.message}
					                </span>
					                <span id="date">${n.date}</span>
				                </div>
			                </div>
                        `)}),Offset++,UpdatingMessagesNow=!1}))})});hubConnection.on("Error",function(n){toastr.error(n)});